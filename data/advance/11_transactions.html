<ion-view view-title="11 - Transactions">
<ion-content style="margin:0 12px">
<div class="col-md-7 middle-col">
	<h1>Transactions</h1>
	<hr>
	<p>A transaction is a unit of work that is performed against a database. Transactions are units or sequences of work accomplished in a logical order, whether in a manual fashion by a user or automatically by some sort of a database program.</p>
	<p>A transaction is the propagation of one or more changes to the database. For example, if you are creating a record or updating a record or deleting a record from the table, then you are performing transaction on the table. It is important to control transactions to ensure data integrity and to handle database errors.</p>
	<p>Practically, you will club many SQL queries into a group  and you will execute all of them together as a part of a transaction.</p>
	<h2>Properties of Transactions:</h2>
	<p>Transactions have the following four standard properties, usually referred to by the acronym ACID:</p>
	<ion-list>
		<li><p><b>Atomicity:</b> ensures that all operations within the work unit are completed successfully; otherwise, the transaction is aborted at the point of failure, and previous operations are rolled back to their former state.</p></li>
		<li><p><b>Consistency:</b> ensures that the database properly changes states upon a successfully committed transaction.</p></li>
		<li><p><b>Isolation:</b> enables transactions to operate independently of and transparent to each other.</p></li>
		<li><p><b>Durability:</b> ensures that the result or effect of a committed transaction persists in case of a system failure.</p></li>
	</ion-list>
	<h2>Transaction Control:</h2>
	<p>There are following commands used to control transactions:</p>
	<ion-list>
		<li><p><b>COMMIT:</b>  to save the changes.</p></li>
		<li><p><b>ROLLBACK:</b> to rollback the changes.</p></li>
		<li><p><b>SAVEPOINT:</b> creates points within groups of transactions in which to ROLLBACK</p></li>
		<li><p><b>SET TRANSACTION:</b> Places a name on a transaction.</p></li>
	</ion-list>
	<p>Transactional control commands are only used with the DML commands INSERT, UPDATE and DELETE only. They can not be used while creating tables or dropping them because these operations are automatically commited in the database.</p>
	<h2>The COMMIT Command:</h2>
	<p>The COMMIT command is the transactional command used to save changes invoked by a transaction to the database.</p>
	<p>The COMMIT command saves all transactions to the database since the last COMMIT or ROLLBACK command.</p>
	<p>The syntax for COMMIT command is as follows:</p>
	<pre class="prettyprint notranslate prettyprinted"><span class="pln">COMMIT</span><span class="pun">;</span></pre>
	<h2>Example:</h2>
	<p>Consider the CUSTOMERS table having the following records:</p>
	<div>
	<table class="table table-bordered">
			<tbody><tr>
				<th>ID</th>
				<th>NAME</th>
				<th>AGE</th>
				<th>ADDRESS</th>
				<th>SALARY</th>
			</tr>
			<tr>
				<td>1<br>2<br>3<br>4<br>5<br>6<br>7</td>
				<td>Ramesh<br>Khilan<br>kaushik<br>
					Chaitali<br>Hardik<br>Komal<br>Muffy</td>
				<td align="center">32<br>25<br>23<br>25<br>27<br>22<br>24</td>
				<td>Ahmedabad<br>Delhi<br>Kota<br>Mumbai<br>Bhopal<br>MP<br>Indore</td>
				<td align="right">2000.00<br>1500.00<br>2000.00<br>
					6500.00<br>8500.00<br>4500.00<br>10000.00</td>				
			</tr>			
		</tbody></table> <br>
</div>
<p>Following is the example which would delete records from the table having age = 25 and then COMMIT the changes in the database.</p>
<pre class="prettyprint notranslate prettyprinted"><span class="pln">SQL</span><span class="pun">&gt;</span><span class="pln"> DELETE FROM CUSTOMERS
	WHERE AGE </span><span class="pun">=</span><span class="pln"> </span><span class="lit">25</span><span class="pun">;</span><span class="pln">
SQL</span><span class="pun">&gt;</span><span class="pln"> COMMIT</span><span class="pun">;</span></pre>
	<p>As a result, two rows from the table would be deleted and SELECT statement would produce the following result:</p>
<div>
	<table class="table table-bordered">
			<tbody><tr>
				<th>ID</th>
				<th>NAME</th>
				<th>AGE</th>
				<th>ADDRESS</th>
				<th>SALARY</th>
			</tr>
			<tr>
				<td>1<br>3<br>5<br>6<br>7</td>
				<td>Ramesh<br>kaushik<br>
					Hardik<br>Komal<br>Muffy</td>
				<td align="center">32<br>23<br>27<br>22<br>24</td>
				<td>Ahmedabad<br>Kota<br>Bhopal<br>MP<br>Indore</td>
				<td align="right">2000.00<br>2000.00<br>
					8500.00<br>4500.00<br>10000.00</td>				
			</tr>			
		</tbody></table> <br>
</div>
<h2>The ROLLBACK Command:</h2>
<p>The ROLLBACK command is the transactional command used to undo transactions that have not already been saved to the database.</p>
<p>The ROLLBACK command can only be used to undo transactions since the last COMMIT or ROLLBACK command was issued.</p>
<p>The syntax for ROLLBACK command is as follows:</p>
<pre class="prettyprint notranslate prettyprinted"><span class="pln">ROLLBACK</span><span class="pun">;</span></pre>
<h2>Example:</h2>
<p>Consider the CUSTOMERS table having the following records:</p>
<div>
	<table class="table table-bordered">
			<tbody><tr>
				<th>ID</th>
				<th>NAME</th>
				<th>AGE</th>
				<th>ADDRESS</th>
				<th>SALARY</th>
			</tr>
			<tr>
				<td>1<br>2<br>3<br>4<br>5<br>6<br>7</td>
				<td>Ramesh<br>Khilan<br>kaushik<br>
					Chaitali<br>Hardik<br>Komal<br>Muffy</td>
				<td align="center">32<br>25<br>23<br>25<br>27<br>22<br>24</td>
				<td>Ahmedabad<br>Delhi<br>Kota<br>Mumbai<br>Bhopal<br>MP<br>Indore</td>
				<td align="right">2000.00<br>1500.00<br>2000.00<br>
					6500.00<br>8500.00<br>4500.00<br>10000.00</td>				
			</tr>			
		</tbody></table> <br>
</div>
<p>Following is the example, which would delete records from the table having age = 25 and then ROLLBACK the changes in the database.</p>
<pre class="prettyprint notranslate prettyprinted"><span class="pln">SQL</span><span class="pun">&gt;</span><span class="pln"> DELETE FROM CUSTOMERS
	WHERE AGE </span><span class="pun">=</span><span class="pln"> </span><span class="lit">25</span><span class="pun">;</span><span class="pln">
SQL</span><span class="pun">&gt;</span><span class="pln"> ROLLBACK</span><span class="pun">;</span></pre>
	<p>As a result, delete operation would not impact the table and SELECT statement would produce the following result:</p>
<div>
	<table class="table table-bordered">
			<tbody><tr>
				<th>ID</th>
				<th>NAME</th>
				<th>AGE</th>
				<th>ADDRESS</th>
				<th>SALARY</th>
			</tr>
			<tr>
				<td>1<br>2<br>3<br>4<br>5<br>6<br>7</td>
				<td>Ramesh<br>Khilan<br>kaushik<br>
					Chaitali<br>Hardik<br>Komal<br>Muffy</td>
				<td align="center">32<br>25<br>23<br>25<br>27<br>22<br>24</td>
				<td>Ahmedabad<br>Delhi<br>Kota<br>Mumbai<br>Bhopal<br>MP<br>Indore</td>
				<td align="right">2000.00<br>1500.00<br>2000.00<br>
					6500.00<br>8500.00<br>4500.00<br>10000.00</td>				
			</tr>			
		</tbody></table> <br>
</div>
<h2>The SAVEPOINT Command:</h2>
<p>A SAVEPOINT is a point in a transaction when you can roll the transaction back to a certain point without rolling back the entire transaction.</p>
<p>The syntax for SAVEPOINT command is as follows:</p>
<pre class="prettyprint notranslate prettyprinted"><span class="pln">SAVEPOINT SAVEPOINT_NAME</span><span class="pun">;</span></pre>
<p>This command serves only in the creation of a SAVEPOINT among transactional statements. The ROLLBACK command is used to undo a group of transactions.</p>
<p>The syntax for rolling back to a SAVEPOINT is as follows:</p>
<pre class="prettyprint notranslate prettyprinted"><span class="pln">ROLLBACK TO SAVEPOINT_NAME</span><span class="pun">;</span></pre>
<p>Following is an example where you plan to delete the three different records from the CUSTOMERS table. You want to create a SAVEPOINT before each delete, so that you can ROLLBACK to any SAVEPOINT at any time to return the appropriate data to its original state:</p>
<h2>Example:</h2>
<p>Consider the CUSTOMERS table having the following records:</p>
<div>
	<table class="table table-bordered">
			<tbody><tr>
				<th>ID</th>
				<th>NAME</th>
				<th>AGE</th>
				<th>ADDRESS</th>
				<th>SALARY</th>
			</tr>
			<tr>
				<td>1<br>2<br>3<br>4<br>5<br>6<br>7</td>
				<td>Ramesh<br>Khilan<br>kaushik<br>
					Chaitali<br>Hardik<br>Komal<br>Muffy</td>
				<td align="center">32<br>25<br>23<br>25<br>27<br>22<br>24</td>
				<td>Ahmedabad<br>Delhi<br>Kota<br>Mumbai<br>Bhopal<br>MP<br>Indore</td>
				<td align="right">2000.00<br>1500.00<br>2000.00<br>
					6500.00<br>8500.00<br>4500.00<br>10000.00</td>				
			</tr>			
		</tbody></table> <br>
</div>
<p>Now, here is the series of operations:</p>
<pre class="prettyprint notranslate prettyprinted"><span class="pln">SQL</span><span class="pun">&gt;</span><span class="pln"> SAVEPOINT SP1</span><span class="pun">;</span><span class="pln">
</span><span class="typ">Savepoint</span><span class="pln"> created</span><span class="pun">.</span><span class="pln">
SQL</span><span class="pun">&gt;</span><span class="pln"> DELETE FROM CUSTOMERS WHERE ID</span><span class="pun">=</span><span class="lit">1</span><span class="pun">;</span><span class="pln">
</span><span class="lit">1</span><span class="pln"> row deleted</span><span class="pun">.</span><span class="pln">
SQL</span><span class="pun">&gt;</span><span class="pln"> SAVEPOINT SP2</span><span class="pun">;</span><span class="pln">
</span><span class="typ">Savepoint</span><span class="pln"> created</span><span class="pun">.</span><span class="pln">
SQL</span><span class="pun">&gt;</span><span class="pln"> DELETE FROM CUSTOMERS WHERE ID</span><span class="pun">=</span><span class="lit">2</span><span class="pun">;</span><span class="pln">
</span><span class="lit">1</span><span class="pln"> row deleted</span><span class="pun">.</span><span class="pln">
SQL</span><span class="pun">&gt;</span><span class="pln"> SAVEPOINT SP3</span><span class="pun">;</span><span class="pln">
</span><span class="typ">Savepoint</span><span class="pln"> created</span><span class="pun">.</span><span class="pln">
SQL</span><span class="pun">&gt;</span><span class="pln"> DELETE FROM CUSTOMERS WHERE ID</span><span class="pun">=</span><span class="lit">3</span><span class="pun">;</span><span class="pln">
</span><span class="lit">1</span><span class="pln"> row deleted</span><span class="pun">.</span></pre>
<p>Now that the three deletions have taken place, say you have changed your mind and decided to ROLLBACK to the SAVEPOINT that you identified as SP2. Because SP2 was created after the first deletion, the last two deletions are undone:</p>
<pre class="prettyprint notranslate prettyprinted"><span class="pln">SQL</span><span class="pun">&gt;</span><span class="pln"> ROLLBACK TO SP2</span><span class="pun">;</span><span class="pln">
</span><span class="typ">Rollback</span><span class="pln"> complete</span><span class="pun">.</span></pre>
<p>Notice that only the first deletion took place since you rolled back to SP2:</p>

<div class="prettyprint">
	SQL> SELECT * FROM CUSTOMERS;<br>
	<table class="table table-bordered">
			<tbody><tr>
				<th>ID</th>
				<th>NAME</th>
				<th>AGE</th>
				<th>ADDRESS</th>
				<th>SALARY</th>
			</tr>
			<tr>
				<td>2<br>3<br>4<br>5<br>6<br>7</td>
				<td>Khilan<br>kaushik<br>
					Chaitali<br>Hardik<br>Komal<br>Muffy</td>
				<td align="center">25<br>23<br>25<br>27<br>22<br>24</td>
				<td>Delhi<br>Kota<br>Mumbai<br>Bhopal<br>MP<br>Indore</td>
				<td align="right">1500.00<br>2000.00<br>
					6500.00<br>8500.00<br>4500.00<br>10000.00</td>				
			</tr>			
		</tbody></table>
		6 rows selected.
</div>

<h2>The RELEASE SAVEPOINT Command:</h2>
<p>The RELEASE SAVEPOINT command is used to remove a SAVEPOINT that you have created. </p>
<p>The syntax for  RELEASE SAVEPOINT is as follows:</p>
<pre class="prettyprint notranslate prettyprinted"><span class="pln">RELEASE SAVEPOINT SAVEPOINT_NAME</span><span class="pun">;</span></pre>
<p>Once a SAVEPOINT has been released, you can no longer use the ROLLBACK command to undo transactions performed since the SAVEPOINT.</p>
<h2>The SET TRANSACTION Command:</h2>
<p>The SET TRANSACTION command can be used to initiate a database transaction. This command is used to specify characteristics for the transaction that follows.</p>
<p>For example, you can specify a transaction to be read only, or read write.</p>
<p>The syntax for  SET TRANSACTION is as follows:</p>
<pre class="prettyprint notranslate prettyprinted"><span class="pln">SET TRANSACTION </span><span class="pun">[</span><span class="pln"> READ WRITE </span><span class="pun">|</span><span class="pln"> READ ONLY </span><span class="pun">];</span></pre>
</ion-content>
</ion-view>
